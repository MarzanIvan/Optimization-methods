import pandas as pd

# Ð”Ð°Ð½Ð½Ñ‹Ðµ: Ð¿Ð°Ñ€Ñ‚Ð¸Ð¸ Ð¸ Ð²ÐµÑ€Ð¾ÑÑ‚Ð½Ð¾ÑÑ‚Ð¸
parties = [0.8, 1.0, 1.2, 1.4]  # % Ð´ÐµÑ„ÐµÐºÑ‚Ð½Ñ‹Ñ…
probabilities = [0.4, 0.3, 0.25, 0.05]  # Ð²ÐµÑ€Ð¾ÑÑ‚Ð½Ð¾ÑÑ‚Ð¸

# ÐŸÐ¾Ñ‚Ñ€ÐµÐ±Ð¸Ñ‚ÐµÐ»Ð¸ Ð¸ Ð¸Ñ… Ð´Ð¾Ð¿ÑƒÑÑ‚Ð¸Ð¼Ñ‹Ðµ ÑƒÑ€Ð¾Ð²Ð½Ð¸ Ð±Ñ€Ð°ÐºÐ°
consumers = {
    "A": 0.8,
    "B": 1.2,
    "C": 1.4
}

# Ð¡Ð¾Ð·Ð´Ð°ÐµÐ¼ Ñ‚Ð°Ð±Ð»Ð¸Ñ†Ñƒ "Ñ€ÐµÑˆÐµÐ½Ð¸Ð¹"
data = []

for party, prob in zip(parties, probabilities):
    for consumer, max_defect in consumers.items():
        diff = round(party - max_defect, 3)  # Ñ€Ð°Ð·Ð½Ð¸Ñ†Ð°
        if diff > 0:
            # ÑˆÑ‚Ñ€Ð°Ñ„
            penalty = diff / 0.1 * -1000
        elif diff < 0:
            # Ð±Ð¾Ð½ÑƒÑ
            penalty = abs(diff) / 0.1 * 500
        else:
            penalty = 0
        expected = penalty * prob
        data.append({
            "ÐŸÐ°Ñ€Ñ‚Ð¸Ñ %": party,
            "ÐŸÐ¾Ñ‚Ñ€ÐµÐ±Ð¸Ñ‚ÐµÐ»ÑŒ": consumer,
            "ÐœÐ°ÐºÑ. Ð´Ð¾Ð¿ÑƒÑ‰ÐµÐ½Ð¾": max_defect,
            "Ð Ð°Ð·Ð½Ð¸Ñ†Ð° %": diff,
            "Ð¨Ñ‚Ñ€Ð°Ñ„/Ð¿Ñ€Ð¸Ð±Ñ‹Ð»ÑŒ": penalty,
            "Ð’ÐµÑ€Ð¾ÑÑ‚Ð½Ð¾ÑÑ‚ÑŒ": prob,
            "ÐžÐ¶Ð¸Ð´Ð°ÐµÐ¼Ñ‹Ð¹ Ð´Ð¾Ñ…Ð¾Ð´": expected
        })

df = pd.DataFrame(data)

# Ð’Ñ‹Ð²Ð¾Ð´ Ð´ÐµÑ€ÐµÐ²Ð° Ñ€ÐµÑˆÐµÐ½Ð¸Ð¹
print("\nÐ”ÐµÑ€ÐµÐ²Ð¾ Ñ€ÐµÑˆÐµÐ½Ð¸Ð¹:\n")
print(df)

# Ð“Ñ€ÑƒÐ¿Ð¿Ð¸Ñ€ÑƒÐµÐ¼ Ð¿Ð¾ Ð¿Ð¾Ñ‚Ñ€ÐµÐ±Ð¸Ñ‚ÐµÐ»ÑÐ¼ â€” ÑÑƒÐ¼Ð¼Ð°Ñ€Ð½Ñ‹Ð¹ Ð¾Ð¶Ð¸Ð´Ð°ÐµÐ¼Ñ‹Ð¹ Ð´Ð¾Ñ…Ð¾Ð´
summary = df.groupby("ÐŸÐ¾Ñ‚Ñ€ÐµÐ±Ð¸Ñ‚ÐµÐ»ÑŒ")["ÐžÐ¶Ð¸Ð´Ð°ÐµÐ¼Ñ‹Ð¹ Ð´Ð¾Ñ…Ð¾Ð´"].sum().sort_values(ascending=False)

print("\nÐ¡ÑƒÐ¼Ð¼Ð°Ñ€Ð½Ð°Ñ Ð¾Ð¶Ð¸Ð´Ð°ÐµÐ¼Ð°Ñ Ð¿Ñ€Ð¸Ð±Ñ‹Ð»ÑŒ/ÑƒÐ±Ñ‹Ñ‚Ð¾Ðº Ð¿Ð¾ Ð¿Ð¾Ñ‚Ñ€ÐµÐ±Ð¸Ñ‚ÐµÐ»ÑÐ¼:\n")
print(summary)

best = summary.idxmax()
print(f"\nðŸ” Ð›ÑƒÑ‡ÑˆÐ¸Ð¹ Ð¿Ð¾Ñ‚Ñ€ÐµÐ±Ð¸Ñ‚ÐµÐ»ÑŒ Ñ Ð½Ð°Ð¸Ð²Ñ‹ÑÑˆÐ¸Ð¼ Ð¿Ñ€Ð¸Ð¾Ñ€Ð¸Ñ‚ÐµÑ‚Ð¾Ð¼: {best}")
